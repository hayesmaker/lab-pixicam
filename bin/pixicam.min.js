!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.pixicam=t()}}(function(){var t;return function t(n,r,e){function i(a,s){if(!r[a]){if(!n[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var c=r[a]={exports:{}};n[a][0].call(c.exports,function(t){var r=n[a][1][t];return i(r?r:t)},c,c.exports,t,n,r,e)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<e.length;a++)i(e[a]);return i}({1:[function(t,n,r){(function(r){var e=n.exports={Camera:t("./camera"),World:t("./world"),Minimap:t("./minimap"),mixins:t("./mixins")};r.pixicam=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./camera":5,"./minimap":9,"./mixins":10,"./world":14}],2:[function(t,n,r){n.exports=function(t,n){if(!t)throw new Error(n)}},{}],3:[function(t,n,r){var e=t("./vendor/augment"),i=(t("./vendor/gl-matrix"),t("./math/rectangle"),t("./math/point")),o=e.defclass({constructor:function(t){this.maxZoom=t.maxZoom||5,this.minZoom=t.minZoom||.1,this.worldBounds=t.worldBounds,this._active=!0},clampZoom:function(t){return t>this.maxZoom?this.maxZoom:t<this.minZoom?this.minZoom:t},limitToWorld:function(t){var n=(new i,t.getViewport()),r=this.worldBounds;if(n.y+n.height>r.y+r.height){var e=t.y+(r.y+r.height-(n.y+n.height));t.y=e}if(n.x<r.x){var e=t.x+(r.x-n.x);t.x=e}if(n.x+n.width>r.x+r.width){var e=t.x+(r.x+r.width-(n.x+n.width));t.x=e}if(n.y<r.y){var e=t.y+(r.y-n.y);t.y=e}},update:function(t){this._active&&(t.zoom=this.clampZoom(t.zoom),this.limitToWorld(t))}});Object.defineProperties(o.prototype,{active:{set:function(t){this._active=t},get:function(){return this._active}}}),n.exports=o},{"./math/point":6,"./math/rectangle":7,"./vendor/augment":12,"./vendor/gl-matrix":13}],4:[function(t,n,r){var e=t("./vendor/augment"),i=t("./vendor/gl-matrix"),o=(t("./math/rectangle"),t("./math/point"),i.vec2),a={NONE:-1,PAN:2},s=e.defclass({constructor:function(t){this.camera=t,this.state=a.NONE,this.panStart=o.fromValues(0,0),this.panEnd=o.fromValues(0,0),this.panDelta=o.fromValues(0,0),this.panCamera=o.fromValues(0,0)},startAt:function(t,n){this.state=a.PAN,o.set(this.panStart,t,n)},end:function(){this.state=a.NONE},pan:function(t,n,r){this.state!=a.NONE&&(r=r||1,this.panLeft(t*r),this.panUp(n*r))},panLeft:function(t){this.panCamera[0]=t},panUp:function(t){this.panCamera[1]=t},applyPan:function(t,n,r){o.set(this.panEnd,t,n),o.subtract(this.panDelta,this.panStart,this.panEnd),this.pan(this.panDelta[0],this.panDelta[1],this.camera.zoom),o.copy(this.panStart,this.panEnd)},update:function(){var t=this.camera.zoom;this.camera.x+=this.panCamera[0]/t,this.camera.y+=this.panCamera[1]/t,o.set(this.panCamera,0,0)}});n.exports=s},{"./math/point":6,"./math/rectangle":7,"./vendor/augment":12,"./vendor/gl-matrix":13}],5:[function(t,n,r){var e=t("./vendor/augment"),i=t("./vendor/gl-matrix"),o=t("./math/rectangle"),a=t("./math/point"),s=i.mat2d,u=i.vec2,h=e.defclass({constructor:function(t,n){this._position=new a(0,0),this._positionLimited=new a(0,0),this._zoomPivot=new a(0,0),this._viewCenter=new a(0,0),this._zoom=1,this._rotation=0,this.view=new o(0,0,t,n),this._viewport=new o(0,0,0,0),this.transform=new PIXI.Matrix},unfollow:function(){this.followTarget=void 0},follow:function(t){this.followTarget=t},getInverseMatrix:function(){var t=this.getMatrix();return s.invert([],t)},cameraToWorldPoint:function(t){return this.worldToScreen(t)},worldToCameraPoint:function(t){return this.screenToWorld(t)},transformPoint:function(t,n){var r=[t.x,t.y];return r=u.transformMat2d([],r,n),{x:r[0],y:r[1]}},worldToScreen:function(t){return this.transformPoint(t,this.getMatrix())},screenToWorld:function(t){return this.transformPoint(t,this.getInverseMatrix())},tranformRect:function(t,n){var r=this.transformPoint(t.tl,n),e=this.transformPoint({x:t.width,y:t.height},n);return new o(r.x,r.y,e.x-r.x,e.y-r.y)},worldRectToScreen:function(t){return this.tranformRect(t,this.getInverseMatrix())},getViewSize:function(){return this.view},setScreenSize:function(t,n){this.view.width=t,this.view.height=n},getViewport:function(){var t=this.worldToScreen(a.ZERO),n=this.worldToScreen({x:this.view.width,y:this.view.height});return this._viewport.set(t.x,t.y,n.x-t.x,n.y-t.y),this._viewport},getMatrix:function(){var t=s.identity([]);s.translate(t,t,[this._zoomPivot.x,this._zoomPivot.y]);var n=[this._position.x,this._position.y];return this.view.x=this._position.x,this.view.y=this._position.y,s.translate(t,t,[-this._viewCenter.x,-this._viewCenter.y]),s.translate(t,t,n),s.scale(t,t,[1/this.zoom,1/this.zoom]),s.rotate(t,t,this._rotation),s.translate(t,t,[-this._zoomPivot.x,-this._zoomPivot.y]),t},update:function(){this.followTarget&&(this.x=this.followTarget.x,this.y=this.followTarget.y),this.updateTransform()},updateTransform:function(){var t=this.getInverseMatrix(),n=this.transform;n.a=t[0],n.b=t[1],n.c=t[2],n.d=t[3],n.tx=t[4],n.ty=t[5]}});Object.defineProperty(h.prototype,"zoom",{get:function(){return this._zoom},set:function(t){t<.1&&(t=.1),this._zoom=t}}),Object.defineProperty(h.prototype,"viewCenterX",{get:function(){return this._viewCenter.x},set:function(t){this._viewCenter.x=t}}),Object.defineProperty(h.prototype,"viewCenterY",{get:function(){return this._viewCenter.y},set:function(t){this._viewCenter.y=t}}),Object.defineProperty(h.prototype,"zoomPivotX",{get:function(){return this._zoomPivot.x},set:function(t){this._zoomPivot.x=t}}),Object.defineProperty(h.prototype,"zoomPivotY",{get:function(){return this._zoomPivot.y},set:function(t){this._zoomPivot.y=t}}),Object.defineProperty(h.prototype,"x",{get:function(){return this._position.x},set:function(t){this._position.x=t}}),Object.defineProperty(h.prototype,"y",{get:function(){return this._position.y},set:function(t){this._position.y=t}}),Object.defineProperty(h.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t}}),n.exports=h},{"./math/point":6,"./math/rectangle":7,"./vendor/augment":12,"./vendor/gl-matrix":13}],6:[function(t,n,r){var e=t("./../vendor/augment"),i=e.defclass({constructor:function(t,n){t=t||0,n=n||0,this.x=t,this.y=n},subtract:function(t){return this.x=this.x-t.x,this.y=this.y-t.y,this},add:function(t){return this.x=this.x+t.x,this.y=this.y+t.y,this},toArray:function(){return[this.x,this.y]},reset:function(){this.set(0,0)},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},divideScalar:function(t){if(0!==t){var n=1/t;this.x*=n,this.y*=n}else this.x=0,this.y=0;return this},clone:function(){return new i(this.x,this.y)},normalize:function(){return this.divideScalar(this.length())},set:function(t,n){return this.x=t,this.y=n,this}});i.ZERO=new i,i.subtract=function(t,n){var r=new i(t.x,t.y),e=new i(n.x,n.y);return r.clone().subtract(e)},i.fromAngle=function(t,n){var r=Math.cos(t)*n,e=Math.sin(t)*n;return new i(r,e)},n.exports=i},{"./../vendor/augment":12}],7:[function(t,n,r){var e=t("./../vendor/augment"),i=t("./../math/point"),o=e.defclass({constructor:function(t,n,r,e){t=t||0,n=n||0,r=r||0,e=e||0,this.x=t,this.y=n,this.width=r,this.height=e},clone:function(){return new o(this.x,this.y,this.width,this.height)},scaleWithPoint:function(t){return this.scale(t.x,t.y)},scale:function(t,n){return"undefined"==typeof n&&(n=t),this.x=this.x*t,this.y=this.y*n,this.width=this.width*t,this.height=this.height*n,this},set:function(t,n,r,e){return this.x=t,this.y=n,this.width=r,this.height=e,this}});Object.defineProperty(o.prototype,"left",{get:function(){return this.x}}),Object.defineProperty(o.prototype,"right",{get:function(){return this.x+this.width}}),Object.defineProperty(o.prototype,"top",{get:function(){return this.y}}),Object.defineProperty(o.prototype,"bottom",{get:function(){return this.y+this.height}}),Object.defineProperty(o.prototype,"tl",{get:function(){return new i(this.x,this.y)},set:function(t){this.x=t.x,this.y=t.y}}),Object.defineProperty(o.prototype,"tr",{get:function(){return new i(this.x+this.width,this.y)}}),Object.defineProperty(o.prototype,"bl",{get:function(){return new i(this.x,this.bottom)}}),Object.defineProperty(o.prototype,"br",{get:function(){return new i(this.right,this.bottom)}}),Object.defineProperty(o.prototype,"centerX",{get:function(){return this.x+this.halfWidth}}),Object.defineProperty(o.prototype,"centerY",{get:function(){return this.y+this.halfHeight}}),Object.defineProperty(o.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}}),Object.defineProperty(o.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}}),n.exports=o},{"./../math/point":6,"./../vendor/augment":12}],8:[function(t,n,r){var e=t("./vendor/augment"),i=t("./vendor/gl-matrix"),o=(t("./math/rectangle"),t("./math/point")),a=t("./camera-pan"),s=(i.mat2d,e.defclass({constructor:function(t){this.minimap=t,t.interactive=!0,t.on("mousedown",this.handleMouseDown),this.camera=this.minimap.camera,this.cameraPan=new a(this.minimap.camera)},handleMouseDown:function(t){var n=this.minimap;n.mouseup=n.mouseupoutside=n.touchend=n.touchendoutside=this.handleMouseUp,n.mousemove=this.handleMouseMove;var r=this.mouseToGlobal(t.data.global);this.cameraPan.startAt(-r.x,-r.y)},handleMouseUp:function(t){var n=this.minimap;n.mouseup=n.mouseupoutside=n.touchend=n.touchendoutside=void 0,n.mousemove=void 0,this.cameraPan.end()},mouseToGlobal:function(t){var n=this.minimap.toLocal(t);return n=new o(n.x,n.y),n=this.minimap.minimapToWorld(n)},handleMouseMove:function(t){var n=this.mouseToGlobal(t.data.global);this.cameraPan.applyPan(-n.x,-n.y)},update:function(){this.cameraPan.update()}}));n.exports=s},{"./camera-pan":4,"./math/point":6,"./math/rectangle":7,"./vendor/augment":12,"./vendor/gl-matrix":13}],9:[function(t,n,r){var e=t("./vendor/augment"),i=t("./vendor/gl-matrix"),o=t("./math/rectangle"),a=t("./minimap-navigator"),s=t("./math/point"),u=i.mat2d,h=e(PIXI.Container,function(t){this.constructor=function(n,r,e,i){t.constructor.apply(this,arguments),this.camera=e,this.minimapDimensions={width:n,height:r},this.worldBoundRect=new o(0,0,100,100),this.viewportRect=new o(0,0,100,100),this.items=[],this.build(),this.navigator=new a(this)},this.build=function(){this.worldBounds=new PIXI.Graphics,this.worldBounds.alpha=.5,this.addChild(this.worldBounds),this.viewport=new PIXI.Graphics,this.viewport.alpha=.5,this.addChild(this.viewport),this.itemsLayer=new PIXI.Graphics,this.addChild(this.itemsLayer),this.debugLayer=new PIXI.Graphics,this.addChild(this.debugLayer)},this.add=function(t){this.items.push(t)},this.drawObjects=function(){this.itemsLayer.clear();for(var t,n=0,r=this.items.length;n<r;n++){t=this.items[n];var e=t.getLocalBounds(),i=0,a=0;t.anchor&&(i=t.width*-t.anchor.x,a=t.height*-t.anchor.y),e=new o(t.x+i,t.y+a,t.width,t.height),this.drawObject(e)}},this.drawObject=function(t){var n=this.worldRectToMinimap(t);this.drawRect(this.itemsLayer,n.x,n.y,n.width,n.height,{color:65535})},this.setWorldBounds=function(t){this.worldBoundRect=t},this.update=function(){this.navigator.update(),this.viewportRect=this.camera.getViewport(),this.draw()},this.getWorldToMinimapRatio=function(){var t=this.getRatios(this.minimapDimensions,this.worldBoundRect);return{x:t.x,y:t.y}},this.getRatios=function(t,n){var r=t.width,e=t.height,i=n.width,o=n.height,a=r/i,s=e/o,u={x:a,y:s,min:Math.min(a,s),max:Math.max(a,s)};return u},this.worldRectToMinimap=function(t){var n=this.getWorldToMinimapRatio(),r=t.clone();return r.tl=r.tl.subtract(this.worldBoundRect.tl),r.scaleWithPoint(n),r},this.minimapToWorld=function(t){t instanceof s||(t=new s(t.x,t.y));var n=t.toArray(),r=u.identity([]),e=this.getWorldToMinimapRatio();return u.translate(r,r,[this.worldBoundRect.x,this.worldBoundRect.y]),u.scale(r,r,[1/e.x,1/e.y]),i.vec2.transformMat2d(n,n,r),new s(n[0],n[1])},this.worldPointToMinimap=function(t){t instanceof s||(t=new s(t.x,t.y));var n=t.toArray(),r=u.identity([]),e=this.getWorldToMinimapRatio();return u.scale(r,r,[e.x,e.y]),u.translate(r,r,[-this.worldBoundRect.x,-this.worldBoundRect.y]),i.vec2.transformMat2d(n,n,r),new s(n[0],n[1])},this.draw=function(){this.drawViewport(this.viewportRect,16776960),this.drawWorldBounds(this.worldBoundRect,0),this.drawObjects()},this.drawViewport=function(t,n){t=this.worldRectToMinimap(t);this.viewport;this.viewport.position.set(t.x,t.y),this.viewport.clear(),this.drawRect(this.viewport,0,0,t.width,t.height,{color:n})},this.drawWorldBounds=function(t,n){var r=t.clone();r.scaleWithPoint(this.getWorldToMinimapRatio()),this.worldBounds.clear(),this.drawRect(this.worldBounds,0,0,r.width,r.height,{color:n}),this.drawOrigin(this.worldBounds,-r.x,-r.y,r.width,r.height)},this.drawRect=function(t,n,r,e,i,o){var o=o||{},a=o.hasOwnProperty("color")?o.color:16777215,s=o.center===!0;t.beginFill(a),s?t.drawRect(n-e/2,r-i/2,e,i):t.drawRect(n,r,e,i),t.endFill()},this.drawOrigin=function(t,n,r,e,i){var o=n,a=r;t.lineStyle(1,16777215,1),t.drawPolygon(n-o,r,n+e-o,r),t.drawPolygon(n,r-a,n,r+i-a)}});Object.defineProperties(h.prototype,{width:{get:function(){return this.minimapDimensions.width}},height:{get:function(){return this.minimapDimensions.height}}}),n.exports=h},{"./math/point":6,"./math/rectangle":7,"./minimap-navigator":8,"./vendor/augment":12,"./vendor/gl-matrix":13}],10:[function(t,n,r){var e=t("./pixi");n.exports={addContainerUpdates:function(){e()}}},{"./pixi":11}],11:[function(t,n,r){var e=function(){PIXI.Container.prototype.update=function(){for(var t=0,n=this.children.length;t<n;++t)this.children[t].update()},PIXI.Container.prototype.preUpdate=function(){for(var t=0,n=this.children.length;t<n;++t)this.children[t].preUpdate()},PIXI.Container.prototype.postUpdate=function(){this.body&&this.body.postUpdate();for(var t=0,n=this.children.length;t<n;++t)this.children[t].postUpdate()}};n.exports=e},{}],12:[function(n,r,e){!function(n,e){"function"==typeof t&&t.amd?t(e):"object"==typeof r?r.exports=e():n.augment=e()}(this,function(){"use strict";var t=function(){},n=Array.prototype.slice,r=function(r,e){var i=t.prototype="function"==typeof r?r.prototype:r,o=new t,a=e.apply(o,n.call(arguments,2).concat(i));if("object"==typeof a)for(var s in a)o[s]=a[s];if(!o.hasOwnProperty("constructor"))return o;var u=o.constructor;return u.prototype=o,u};return r.defclass=function(t){var n=t.constructor;return n.prototype=t,n},r.extend=function(t,n){return r(t,function(t){return this.uber=t,n})},r})},{}],13:[function(n,r,e){!function(n){"use strict";var r={};"undefined"==typeof e?"function"==typeof t&&"object"==typeof t.amd&&t.amd?(r.exports={},t(function(){return r.exports})):r.exports="undefined"!=typeof window?window:n:r.exports=e,function(t){if(!n)var n=1e-6;if(!r)var r="undefined"!=typeof Float32Array?Float32Array:Array;if(!e)var e=Math.random;var i={};i.setMatrixArrayType=function(t){r=t},"undefined"!=typeof t&&(t.glMatrix=i);var o=Math.PI/180;i.toRadian=function(t){return t*o};var a={};a.create=function(){var t=new r(2);return t[0]=0,t[1]=0,t},a.clone=function(t){var n=new r(2);return n[0]=t[0],n[1]=t[1],n},a.fromValues=function(t,n){var e=new r(2);return e[0]=t,e[1]=n,e},a.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t},a.set=function(t,n,r){return t[0]=n,t[1]=r,t},a.add=function(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t},a.subtract=function(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t},a.sub=a.subtract,a.multiply=function(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t},a.mul=a.multiply,a.divide=function(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t},a.div=a.divide,a.min=function(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t},a.max=function(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t},a.scale=function(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t},a.scaleAndAdd=function(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t},a.distance=function(t,n){var r=n[0]-t[0],e=n[1]-t[1];return Math.sqrt(r*r+e*e)},a.dist=a.distance,a.squaredDistance=function(t,n){var r=n[0]-t[0],e=n[1]-t[1];return r*r+e*e},a.sqrDist=a.squaredDistance,a.length=function(t){var n=t[0],r=t[1];return Math.sqrt(n*n+r*r)},a.len=a.length,a.squaredLength=function(t){var n=t[0],r=t[1];return n*n+r*r},a.sqrLen=a.squaredLength,a.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t},a.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t},a.normalize=function(t,n){var r=n[0],e=n[1],i=r*r+e*e;return i>0&&(i=1/Math.sqrt(i),t[0]=n[0]*i,t[1]=n[1]*i),t},a.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]},a.cross=function(t,n,r){var e=n[0]*r[1]-n[1]*r[0];return t[0]=t[1]=0,t[2]=e,t},a.lerp=function(t,n,r,e){var i=n[0],o=n[1];return t[0]=i+e*(r[0]-i),t[1]=o+e*(r[1]-o),t},a.random=function(t,n){n=n||1;var r=2*e()*Math.PI;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t},a.transformMat2=function(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[2]*i,t[1]=r[1]*e+r[3]*i,t},a.transformMat2d=function(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[2]*i+r[4],t[1]=r[1]*e+r[3]*i+r[5],t},a.transformMat3=function(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[3]*i+r[6],t[1]=r[1]*e+r[4]*i+r[7],t},a.transformMat4=function(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[4]*i+r[12],t[1]=r[1]*e+r[5]*i+r[13],t},a.forEach=function(){var t=a.create();return function(n,r,e,i,o,a){var s,u;for(r||(r=2),e||(e=0),u=i?Math.min(i*r+e,n.length):n.length,s=e;s<u;s+=r)t[0]=n[s],t[1]=n[s+1],o(t,t,a),n[s]=t[0],n[s+1]=t[1];return n}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!=typeof t&&(t.vec2=a);var s={};s.create=function(){var t=new r(3);return t[0]=0,t[1]=0,t[2]=0,t},s.clone=function(t){var n=new r(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},s.fromValues=function(t,n,e){var i=new r(3);return i[0]=t,i[1]=n,i[2]=e,i},s.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},s.set=function(t,n,r,e){return t[0]=n,t[1]=r,t[2]=e,t},s.add=function(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t},s.subtract=function(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t},s.sub=s.subtract,s.multiply=function(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t},s.mul=s.multiply,s.divide=function(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t},s.div=s.divide,s.min=function(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t},s.max=function(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t},s.scale=function(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t},s.scaleAndAdd=function(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t},s.distance=function(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2];return Math.sqrt(r*r+e*e+i*i)},s.dist=s.distance,s.squaredDistance=function(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2];return r*r+e*e+i*i},s.sqrDist=s.squaredDistance,s.length=function(t){var n=t[0],r=t[1],e=t[2];return Math.sqrt(n*n+r*r+e*e)},s.len=s.length,s.squaredLength=function(t){var n=t[0],r=t[1],e=t[2];return n*n+r*r+e*e},s.sqrLen=s.squaredLength,s.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t},s.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t},s.normalize=function(t,n){var r=n[0],e=n[1],i=n[2],o=r*r+e*e+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o),t},s.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},s.cross=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=r[0],s=r[1],u=r[2];return t[0]=i*u-o*s,t[1]=o*a-e*u,t[2]=e*s-i*a,t},s.lerp=function(t,n,r,e){var i=n[0],o=n[1],a=n[2];return t[0]=i+e*(r[0]-i),t[1]=o+e*(r[1]-o),t[2]=a+e*(r[2]-a),t},s.random=function(t,n){n=n||1;var r=2*e()*Math.PI,i=2*e()-1,o=Math.sqrt(1-i*i)*n;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=i*n,t},s.transformMat4=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=r[3]*e+r[7]*i+r[11]*o+r[15];return a=a||1,t[0]=(r[0]*e+r[4]*i+r[8]*o+r[12])/a,t[1]=(r[1]*e+r[5]*i+r[9]*o+r[13])/a,t[2]=(r[2]*e+r[6]*i+r[10]*o+r[14])/a,t},s.transformMat3=function(t,n,r){var e=n[0],i=n[1],o=n[2];return t[0]=e*r[0]+i*r[3]+o*r[6],t[1]=e*r[1]+i*r[4]+o*r[7],t[2]=e*r[2]+i*r[5]+o*r[8],t},s.transformQuat=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=r[0],s=r[1],u=r[2],h=r[3],c=h*e+s*o-u*i,f=h*i+u*e-a*o,d=h*o+a*i-s*e,l=-a*e-s*i-u*o;return t[0]=c*h+l*-a+f*-u-d*-s,t[1]=f*h+l*-s+d*-a-c*-u,t[2]=d*h+l*-u+c*-s-f*-a,t},s.rotateX=function(t,n,r,e){var i=[],o=[];return i[0]=n[0]-r[0],i[1]=n[1]-r[1],i[2]=n[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(e)-i[2]*Math.sin(e),o[2]=i[1]*Math.sin(e)+i[2]*Math.cos(e),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},s.rotateY=function(t,n,r,e){var i=[],o=[];return i[0]=n[0]-r[0],i[1]=n[1]-r[1],i[2]=n[2]-r[2],o[0]=i[2]*Math.sin(e)+i[0]*Math.cos(e),o[1]=i[1],o[2]=i[2]*Math.cos(e)-i[0]*Math.sin(e),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},s.rotateZ=function(t,n,r,e){var i=[],o=[];return i[0]=n[0]-r[0],i[1]=n[1]-r[1],i[2]=n[2]-r[2],o[0]=i[0]*Math.cos(e)-i[1]*Math.sin(e),o[1]=i[0]*Math.sin(e)+i[1]*Math.cos(e),o[2]=i[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},s.forEach=function(){var t=s.create();return function(n,r,e,i,o,a){var s,u;for(r||(r=3),e||(e=0),u=i?Math.min(i*r+e,n.length):n.length,s=e;s<u;s+=r)t[0]=n[s],t[1]=n[s+1],t[2]=n[s+2],o(t,t,a),n[s]=t[0],n[s+1]=t[1],n[s+2]=t[2];return n}}(),s.angle=function(t,n){var r=s.fromValues(t[0],t[1],t[2]),e=s.fromValues(n[0],n[1],n[2]);s.normalize(r,r),s.normalize(e,e);var i=s.dot(r,e);return i>1?0:Math.acos(i)},s.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!=typeof t&&(t.vec3=s);var u={};u.create=function(){var t=new r(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},u.clone=function(t){var n=new r(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},u.fromValues=function(t,n,e,i){var o=new r(4);return o[0]=t,o[1]=n,o[2]=e,o[3]=i,o},u.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},u.set=function(t,n,r,e,i){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t},u.add=function(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t},u.subtract=function(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t},u.sub=u.subtract,u.multiply=function(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t[3]=n[3]*r[3],t},u.mul=u.multiply,u.divide=function(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t[3]=n[3]/r[3],t},u.div=u.divide,u.min=function(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t[3]=Math.min(n[3],r[3]),t},u.max=function(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t[3]=Math.max(n[3],r[3]),t},u.scale=function(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t},u.scaleAndAdd=function(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t},u.distance=function(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2],o=n[3]-t[3];return Math.sqrt(r*r+e*e+i*i+o*o)},u.dist=u.distance,u.squaredDistance=function(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2],o=n[3]-t[3];return r*r+e*e+i*i+o*o},u.sqrDist=u.squaredDistance,u.length=function(t){var n=t[0],r=t[1],e=t[2],i=t[3];return Math.sqrt(n*n+r*r+e*e+i*i)},u.len=u.length,u.squaredLength=function(t){var n=t[0],r=t[1],e=t[2],i=t[3];return n*n+r*r+e*e+i*i},u.sqrLen=u.squaredLength,u.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t},u.inverse=function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t},u.normalize=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r*r+e*e+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a),t},u.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]},u.lerp=function(t,n,r,e){var i=n[0],o=n[1],a=n[2],s=n[3];return t[0]=i+e*(r[0]-i),t[1]=o+e*(r[1]-o),t[2]=a+e*(r[2]-a),t[3]=s+e*(r[3]-s),t},u.random=function(t,n){return n=n||1,t[0]=e(),t[1]=e(),t[2]=e(),t[3]=e(),u.normalize(t,t),u.scale(t,t,n),t},u.transformMat4=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3];return t[0]=r[0]*e+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*e+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*e+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*e+r[7]*i+r[11]*o+r[15]*a,t},u.transformQuat=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=r[0],s=r[1],u=r[2],h=r[3],c=h*e+s*o-u*i,f=h*i+u*e-a*o,d=h*o+a*i-s*e,l=-a*e-s*i-u*o;return t[0]=c*h+l*-a+f*-u-d*-s,t[1]=f*h+l*-s+d*-a-c*-u,t[2]=d*h+l*-u+c*-s-f*-a,t},u.forEach=function(){var t=u.create();return function(n,r,e,i,o,a){var s,u;for(r||(r=4),e||(e=0),u=i?Math.min(i*r+e,n.length):n.length,s=e;s<u;s+=r)t[0]=n[s],t[1]=n[s+1],t[2]=n[s+2],t[3]=n[s+3],o(t,t,a),n[s]=t[0],n[s+1]=t[1],n[s+2]=t[2],n[s+3]=t[3];return n}}(),u.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.vec4=u);var h={};h.create=function(){var t=new r(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},h.clone=function(t){var n=new r(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},h.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},h.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},h.transpose=function(t,n){if(t===n){var r=n[1];t[1]=n[2],t[2]=r}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t},h.invert=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r*o-i*e;return a?(a=1/a,t[0]=o*a,t[1]=-e*a,t[2]=-i*a,t[3]=r*a,t):null},h.adjoint=function(t,n){var r=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=r,t},h.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},h.multiply=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=r[0],u=r[1],h=r[2],c=r[3];return t[0]=e*s+o*u,t[1]=i*s+a*u,t[2]=e*h+o*c,t[3]=i*h+a*c,t},h.mul=h.multiply,h.rotate=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(r),u=Math.cos(r);return t[0]=e*u+o*s,t[1]=i*u+a*s,t[2]=e*-s+o*u,t[3]=i*-s+a*u,t},h.scale=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=r[0],u=r[1];return t[0]=e*s,t[1]=i*s,t[2]=o*u,t[3]=a*u,t},h.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},h.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},h.LDU=function(t,n,r,e){return t[2]=e[2]/e[0],r[0]=e[0],r[1]=e[1],r[3]=e[3]-t[2]*r[1],[t,n,r]},"undefined"!=typeof t&&(t.mat2=h);var c={};c.create=function(){var t=new r(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},c.clone=function(t){var n=new r(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n},c.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},c.invert=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=r*o-e*i;return u?(u=1/u,t[0]=o*u,t[1]=-e*u,t[2]=-i*u,t[3]=r*u,t[4]=(i*s-o*a)*u,t[5]=(e*a-r*s)*u,t):null},c.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},c.multiply=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],h=r[0],c=r[1],f=r[2],d=r[3],l=r[4],m=r[5];return t[0]=e*h+o*c,t[1]=i*h+a*c,t[2]=e*f+o*d,t[3]=i*f+a*d,t[4]=e*l+o*m+s,t[5]=i*l+a*m+u,t},c.mul=c.multiply,c.rotate=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],h=Math.sin(r),c=Math.cos(r);return t[0]=e*c+o*h,t[1]=i*c+a*h,t[2]=e*-h+o*c,t[3]=i*-h+a*c,t[4]=s,t[5]=u,t},c.scale=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],h=r[0],c=r[1];return t[0]=e*h,t[1]=i*h,t[2]=o*c,t[3]=a*c,t[4]=s,t[5]=u,t},c.translate=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],h=r[0],c=r[1];return t[0]=e,t[1]=i,t[2]=o,t[3]=a,t[4]=e*h+o*c+s,t[5]=i*h+a*c+u,t},c.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},c.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},"undefined"!=typeof t&&(t.mat2d=c);var f={};f.create=function(){var t=new r(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},f.fromMat4=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t},f.clone=function(t){var n=new r(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},f.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},f.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},f.transpose=function(t,n){if(t===n){var r=n[1],e=n[2],i=n[5];t[1]=n[3],t[2]=n[6],t[3]=r,t[5]=n[7],t[6]=e,t[7]=i}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t},f.invert=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],h=n[7],c=n[8],f=c*a-s*h,d=-c*o+s*u,l=h*o-a*u,m=r*f+e*d+i*l;return m?(m=1/m,t[0]=f*m,t[1]=(-c*e+i*h)*m,t[2]=(s*e-i*a)*m,t[3]=d*m,t[4]=(c*r-i*u)*m,t[5]=(-s*r+i*o)*m,t[6]=l*m,t[7]=(-h*r+e*u)*m,t[8]=(a*r-e*o)*m,t):null},f.adjoint=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],h=n[7],c=n[8];return t[0]=a*c-s*h,t[1]=i*h-e*c,t[2]=e*s-i*a,t[3]=s*u-o*c,t[4]=r*c-i*u,t[5]=i*o-r*s,t[6]=o*h-a*u,t[7]=e*u-r*h,t[8]=r*a-e*o,t},f.determinant=function(t){var n=t[0],r=t[1],e=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],h=t[8];return n*(h*o-a*u)+r*(-h*i+a*s)+e*(u*i-o*s)},f.multiply=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],h=n[6],c=n[7],f=n[8],d=r[0],l=r[1],m=r[2],p=r[3],v=r[4],w=r[5],y=r[6],M=r[7],g=r[8];return t[0]=d*e+l*a+m*h,t[1]=d*i+l*s+m*c,t[2]=d*o+l*u+m*f,t[3]=p*e+v*a+w*h,t[4]=p*i+v*s+w*c,t[5]=p*o+v*u+w*f,t[6]=y*e+M*a+g*h,t[7]=y*i+M*s+g*c,t[8]=y*o+M*u+g*f,t},f.mul=f.multiply,f.translate=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],h=n[6],c=n[7],f=n[8],d=r[0],l=r[1];return t[0]=e,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=d*e+l*a+h,t[7]=d*i+l*s+c,t[8]=d*o+l*u+f,t},f.rotate=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],h=n[6],c=n[7],f=n[8],d=Math.sin(r),l=Math.cos(r);return t[0]=l*e+d*a,t[1]=l*i+d*s,t[2]=l*o+d*u,t[3]=l*a-d*e,t[4]=l*s-d*i,t[5]=l*u-d*o,t[6]=h,t[7]=c,t[8]=f,t},f.scale=function(t,n,r){var e=r[0],i=r[1];return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=i*n[3],t[4]=i*n[4],t[5]=i*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},f.fromMat2d=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t},f.fromQuat=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r+r,s=e+e,u=i+i,h=r*a,c=e*a,f=e*s,d=i*a,l=i*s,m=i*u,p=o*a,v=o*s,w=o*u;return t[0]=1-f-m,t[3]=c-w,t[6]=d+v,t[1]=c+w,t[4]=1-h-m,t[7]=l-p,t[2]=d-v,t[5]=l+p,t[8]=1-h-f,t},f.normalFromMat4=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],h=n[7],c=n[8],f=n[9],d=n[10],l=n[11],m=n[12],p=n[13],v=n[14],w=n[15],y=r*s-e*a,M=r*u-i*a,g=r*h-o*a,x=e*u-i*s,b=e*h-o*s,P=i*h-o*u,_=c*p-f*m,C=c*v-d*m,q=c*w-l*m,T=f*v-d*p,z=f*w-l*p,O=d*w-l*v,R=y*O-M*z+g*T+x*q-b*C+P*_;return R?(R=1/R,t[0]=(s*O-u*z+h*T)*R,t[1]=(u*q-a*O-h*C)*R,t[2]=(a*z-s*q+h*_)*R,t[3]=(i*z-e*O-o*T)*R,t[4]=(r*O-i*q+o*C)*R,t[5]=(e*q-r*z-o*_)*R,t[6]=(p*P-v*b+w*x)*R,t[7]=(v*g-m*P-w*M)*R,t[8]=(m*b-p*g+w*y)*R,t):null},f.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},f.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},"undefined"!=typeof t&&(t.mat3=f);var d={};d.create=function(){var t=new r(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},d.clone=function(t){var n=new r(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},d.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],
t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},d.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},d.transpose=function(t,n){if(t===n){var r=n[1],e=n[2],i=n[3],o=n[6],a=n[7],s=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=r,t[6]=n[9],t[7]=n[13],t[8]=e,t[9]=o,t[11]=n[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t},d.invert=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],h=n[7],c=n[8],f=n[9],d=n[10],l=n[11],m=n[12],p=n[13],v=n[14],w=n[15],y=r*s-e*a,M=r*u-i*a,g=r*h-o*a,x=e*u-i*s,b=e*h-o*s,P=i*h-o*u,_=c*p-f*m,C=c*v-d*m,q=c*w-l*m,T=f*v-d*p,z=f*w-l*p,O=d*w-l*v,R=y*O-M*z+g*T+x*q-b*C+P*_;return R?(R=1/R,t[0]=(s*O-u*z+h*T)*R,t[1]=(i*z-e*O-o*T)*R,t[2]=(p*P-v*b+w*x)*R,t[3]=(d*b-f*P-l*x)*R,t[4]=(u*q-a*O-h*C)*R,t[5]=(r*O-i*q+o*C)*R,t[6]=(v*g-m*P-w*M)*R,t[7]=(c*P-d*g+l*M)*R,t[8]=(a*z-s*q+h*_)*R,t[9]=(e*q-r*z-o*_)*R,t[10]=(m*b-p*g+w*y)*R,t[11]=(f*g-c*b-l*y)*R,t[12]=(s*C-a*T-u*_)*R,t[13]=(r*T-e*C+i*_)*R,t[14]=(p*M-m*x-v*y)*R,t[15]=(c*x-f*M+d*y)*R,t):null},d.adjoint=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],h=n[7],c=n[8],f=n[9],d=n[10],l=n[11],m=n[12],p=n[13],v=n[14],w=n[15];return t[0]=s*(d*w-l*v)-f*(u*w-h*v)+p*(u*l-h*d),t[1]=-(e*(d*w-l*v)-f*(i*w-o*v)+p*(i*l-o*d)),t[2]=e*(u*w-h*v)-s*(i*w-o*v)+p*(i*h-o*u),t[3]=-(e*(u*l-h*d)-s*(i*l-o*d)+f*(i*h-o*u)),t[4]=-(a*(d*w-l*v)-c*(u*w-h*v)+m*(u*l-h*d)),t[5]=r*(d*w-l*v)-c*(i*w-o*v)+m*(i*l-o*d),t[6]=-(r*(u*w-h*v)-a*(i*w-o*v)+m*(i*h-o*u)),t[7]=r*(u*l-h*d)-a*(i*l-o*d)+c*(i*h-o*u),t[8]=a*(f*w-l*p)-c*(s*w-h*p)+m*(s*l-h*f),t[9]=-(r*(f*w-l*p)-c*(e*w-o*p)+m*(e*l-o*f)),t[10]=r*(s*w-h*p)-a*(e*w-o*p)+m*(e*h-o*s),t[11]=-(r*(s*l-h*f)-a*(e*l-o*f)+c*(e*h-o*s)),t[12]=-(a*(f*v-d*p)-c*(s*v-u*p)+m*(s*d-u*f)),t[13]=r*(f*v-d*p)-c*(e*v-i*p)+m*(e*d-i*f),t[14]=-(r*(s*v-u*p)-a*(e*v-i*p)+m*(e*u-i*s)),t[15]=r*(s*d-u*f)-a*(e*d-i*f)+c*(e*u-i*s),t},d.determinant=function(t){var n=t[0],r=t[1],e=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],h=t[8],c=t[9],f=t[10],d=t[11],l=t[12],m=t[13],p=t[14],v=t[15],w=n*a-r*o,y=n*s-e*o,M=n*u-i*o,g=r*s-e*a,x=r*u-i*a,b=e*u-i*s,P=h*m-c*l,_=h*p-f*l,C=h*v-d*l,q=c*p-f*m,T=c*v-d*m,z=f*v-d*p;return w*z-y*T+M*q+g*C-x*_+b*P},d.multiply=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],h=n[6],c=n[7],f=n[8],d=n[9],l=n[10],m=n[11],p=n[12],v=n[13],w=n[14],y=n[15],M=r[0],g=r[1],x=r[2],b=r[3];return t[0]=M*e+g*s+x*f+b*p,t[1]=M*i+g*u+x*d+b*v,t[2]=M*o+g*h+x*l+b*w,t[3]=M*a+g*c+x*m+b*y,M=r[4],g=r[5],x=r[6],b=r[7],t[4]=M*e+g*s+x*f+b*p,t[5]=M*i+g*u+x*d+b*v,t[6]=M*o+g*h+x*l+b*w,t[7]=M*a+g*c+x*m+b*y,M=r[8],g=r[9],x=r[10],b=r[11],t[8]=M*e+g*s+x*f+b*p,t[9]=M*i+g*u+x*d+b*v,t[10]=M*o+g*h+x*l+b*w,t[11]=M*a+g*c+x*m+b*y,M=r[12],g=r[13],x=r[14],b=r[15],t[12]=M*e+g*s+x*f+b*p,t[13]=M*i+g*u+x*d+b*v,t[14]=M*o+g*h+x*l+b*w,t[15]=M*a+g*c+x*m+b*y,t},d.mul=d.multiply,d.translate=function(t,n,r){var e,i,o,a,s,u,h,c,f,d,l,m,p=r[0],v=r[1],w=r[2];return n===t?(t[12]=n[0]*p+n[4]*v+n[8]*w+n[12],t[13]=n[1]*p+n[5]*v+n[9]*w+n[13],t[14]=n[2]*p+n[6]*v+n[10]*w+n[14],t[15]=n[3]*p+n[7]*v+n[11]*w+n[15]):(e=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],h=n[6],c=n[7],f=n[8],d=n[9],l=n[10],m=n[11],t[0]=e,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=h,t[7]=c,t[8]=f,t[9]=d,t[10]=l,t[11]=m,t[12]=e*p+s*v+f*w+n[12],t[13]=i*p+u*v+d*w+n[13],t[14]=o*p+h*v+l*w+n[14],t[15]=a*p+c*v+m*w+n[15]),t},d.scale=function(t,n,r){var e=r[0],i=r[1],o=r[2];return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},d.rotate=function(t,r,e,i){var o,a,s,u,h,c,f,d,l,m,p,v,w,y,M,g,x,b,P,_,C,q,T,z,O=i[0],R=i[1],I=i[2],j=Math.sqrt(O*O+R*R+I*I);return Math.abs(j)<n?null:(j=1/j,O*=j,R*=j,I*=j,o=Math.sin(e),a=Math.cos(e),s=1-a,u=r[0],h=r[1],c=r[2],f=r[3],d=r[4],l=r[5],m=r[6],p=r[7],v=r[8],w=r[9],y=r[10],M=r[11],g=O*O*s+a,x=R*O*s+I*o,b=I*O*s-R*o,P=O*R*s-I*o,_=R*R*s+a,C=I*R*s+O*o,q=O*I*s+R*o,T=R*I*s-O*o,z=I*I*s+a,t[0]=u*g+d*x+v*b,t[1]=h*g+l*x+w*b,t[2]=c*g+m*x+y*b,t[3]=f*g+p*x+M*b,t[4]=u*P+d*_+v*C,t[5]=h*P+l*_+w*C,t[6]=c*P+m*_+y*C,t[7]=f*P+p*_+M*C,t[8]=u*q+d*T+v*z,t[9]=h*q+l*T+w*z,t[10]=c*q+m*T+y*z,t[11]=f*q+p*T+M*z,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)},d.rotateX=function(t,n,r){var e=Math.sin(r),i=Math.cos(r),o=n[4],a=n[5],s=n[6],u=n[7],h=n[8],c=n[9],f=n[10],d=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=o*i+h*e,t[5]=a*i+c*e,t[6]=s*i+f*e,t[7]=u*i+d*e,t[8]=h*i-o*e,t[9]=c*i-a*e,t[10]=f*i-s*e,t[11]=d*i-u*e,t},d.rotateY=function(t,n,r){var e=Math.sin(r),i=Math.cos(r),o=n[0],a=n[1],s=n[2],u=n[3],h=n[8],c=n[9],f=n[10],d=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i-h*e,t[1]=a*i-c*e,t[2]=s*i-f*e,t[3]=u*i-d*e,t[8]=o*e+h*i,t[9]=a*e+c*i,t[10]=s*e+f*i,t[11]=u*e+d*i,t},d.rotateZ=function(t,n,r){var e=Math.sin(r),i=Math.cos(r),o=n[0],a=n[1],s=n[2],u=n[3],h=n[4],c=n[5],f=n[6],d=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i+h*e,t[1]=a*i+c*e,t[2]=s*i+f*e,t[3]=u*i+d*e,t[4]=h*i-o*e,t[5]=c*i-a*e,t[6]=f*i-s*e,t[7]=d*i-u*e,t},d.fromRotationTranslation=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=e+e,u=i+i,h=o+o,c=e*s,f=e*u,d=e*h,l=i*u,m=i*h,p=o*h,v=a*s,w=a*u,y=a*h;return t[0]=1-(l+p),t[1]=f+y,t[2]=d-w,t[3]=0,t[4]=f-y,t[5]=1-(c+p),t[6]=m+v,t[7]=0,t[8]=d+w,t[9]=m-v,t[10]=1-(c+l),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},d.fromQuat=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r+r,s=e+e,u=i+i,h=r*a,c=e*a,f=e*s,d=i*a,l=i*s,m=i*u,p=o*a,v=o*s,w=o*u;return t[0]=1-f-m,t[1]=c+w,t[2]=d-v,t[3]=0,t[4]=c-w,t[5]=1-h-m,t[6]=l+p,t[7]=0,t[8]=d+v,t[9]=l-p,t[10]=1-h-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},d.frustum=function(t,n,r,e,i,o,a){var s=1/(r-n),u=1/(i-e),h=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(r+n)*s,t[9]=(i+e)*u,t[10]=(a+o)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*h,t[15]=0,t},d.perspective=function(t,n,r,e,i){var o=1/Math.tan(n/2),a=1/(e-i);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+e)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*e*a,t[15]=0,t},d.ortho=function(t,n,r,e,i,o,a){var s=1/(n-r),u=1/(e-i),h=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(n+r)*s,t[13]=(i+e)*u,t[14]=(a+o)*h,t[15]=1,t},d.lookAt=function(t,r,e,i){var o,a,s,u,h,c,f,l,m,p,v=r[0],w=r[1],y=r[2],M=i[0],g=i[1],x=i[2],b=e[0],P=e[1],_=e[2];return Math.abs(v-b)<n&&Math.abs(w-P)<n&&Math.abs(y-_)<n?d.identity(t):(f=v-b,l=w-P,m=y-_,p=1/Math.sqrt(f*f+l*l+m*m),f*=p,l*=p,m*=p,o=g*m-x*l,a=x*f-M*m,s=M*l-g*f,p=Math.sqrt(o*o+a*a+s*s),p?(p=1/p,o*=p,a*=p,s*=p):(o=0,a=0,s=0),u=l*s-m*a,h=m*o-f*s,c=f*a-l*o,p=Math.sqrt(u*u+h*h+c*c),p?(p=1/p,u*=p,h*=p,c*=p):(u=0,h=0,c=0),t[0]=o,t[1]=u,t[2]=f,t[3]=0,t[4]=a,t[5]=h,t[6]=l,t[7]=0,t[8]=s,t[9]=c,t[10]=m,t[11]=0,t[12]=-(o*v+a*w+s*y),t[13]=-(u*v+h*w+c*y),t[14]=-(f*v+l*w+m*y),t[15]=1,t)},d.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},d.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},"undefined"!=typeof t&&(t.mat4=d);var l={};l.create=function(){var t=new r(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},l.rotationTo=function(){var t=s.create(),n=s.fromValues(1,0,0),r=s.fromValues(0,1,0);return function(e,i,o){var a=s.dot(i,o);return a<-.999999?(s.cross(t,n,i),s.length(t)<1e-6&&s.cross(t,r,i),s.normalize(t,t),l.setAxisAngle(e,t,Math.PI),e):a>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(s.cross(t,i,o),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1+a,l.normalize(e,e))}}(),l.setAxes=function(){var t=f.create();return function(n,r,e,i){return t[0]=e[0],t[3]=e[1],t[6]=e[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],l.normalize(n,l.fromMat3(n,t))}}(),l.clone=u.clone,l.fromValues=u.fromValues,l.copy=u.copy,l.set=u.set,l.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},l.setAxisAngle=function(t,n,r){r=.5*r;var e=Math.sin(r);return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=Math.cos(r),t},l.add=u.add,l.multiply=function(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],s=r[0],u=r[1],h=r[2],c=r[3];return t[0]=e*c+a*s+i*h-o*u,t[1]=i*c+a*u+o*s-e*h,t[2]=o*c+a*h+e*u-i*s,t[3]=a*c-e*s-i*u-o*h,t},l.mul=l.multiply,l.scale=u.scale,l.rotateX=function(t,n,r){r*=.5;var e=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(r),u=Math.cos(r);return t[0]=e*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-e*s,t},l.rotateY=function(t,n,r){r*=.5;var e=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(r),u=Math.cos(r);return t[0]=e*u-o*s,t[1]=i*u+a*s,t[2]=o*u+e*s,t[3]=a*u-i*s,t},l.rotateZ=function(t,n,r){r*=.5;var e=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(r),u=Math.cos(r);return t[0]=e*u+i*s,t[1]=i*u-e*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t},l.calculateW=function(t,n){var r=n[0],e=n[1],i=n[2];return t[0]=r,t[1]=e,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-e*e-i*i)),t},l.dot=u.dot,l.lerp=u.lerp,l.slerp=function(t,n,r,e){var i,o,a,s,u,h=n[0],c=n[1],f=n[2],d=n[3],l=r[0],m=r[1],p=r[2],v=r[3];return o=h*l+c*m+f*p+d*v,o<0&&(o=-o,l=-l,m=-m,p=-p,v=-v),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-e)*i)/a,u=Math.sin(e*i)/a):(s=1-e,u=e),t[0]=s*h+u*l,t[1]=s*c+u*m,t[2]=s*f+u*p,t[3]=s*d+u*v,t},l.invert=function(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r*r+e*e+i*i+o*o,s=a?1/a:0;return t[0]=-r*s,t[1]=-e*s,t[2]=-i*s,t[3]=o*s,t},l.conjugate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t},l.length=u.length,l.len=l.length,l.squaredLength=u.squaredLength,l.sqrLen=l.squaredLength,l.normalize=u.normalize,l.fromMat3=function(t,n){var r,e=n[0]+n[4]+n[8];if(e>0)r=Math.sqrt(e+1),t[3]=.5*r,r=.5/r,t[0]=(n[5]-n[7])*r,t[1]=(n[6]-n[2])*r,t[2]=(n[1]-n[3])*r;else{var i=0;n[4]>n[0]&&(i=1),n[8]>n[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;r=Math.sqrt(n[3*i+i]-n[3*o+o]-n[3*a+a]+1),t[i]=.5*r,r=.5/r,t[3]=(n[3*o+a]-n[3*a+o])*r,t[o]=(n[3*o+i]+n[3*i+o])*r,t[a]=(n[3*a+i]+n[3*i+a])*r}return t},l.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.quat=l)}(r.exports)}(this)},{}],14:[function(t,n,r){var e=t("./vendor/augment"),i=t("./camera"),o=t("./math/rectangle"),a=t("./minimap"),s=t("./camera-constrain"),u=t("./mixins"),h=t("./assert"),c=e(PIXI.Container,function(t){this.constructor=function(n){t.constructor.apply(this,arguments);var r=n.x||0,e=n.y||-n.height/2,a=n.screenWidth,u=n.screenHeight;h(a,"You must provide a screen width"),h(u,"You must provide a screen height"),this.worldRectangle=new o(r,e,n.width,n.height),this.camera=new i(a,u),this.camera.viewCenterX=a/2,this.camera.viewCenterY=u/2,this.camera.zoomPivotX=a/2,this.camera.zoomPivotY=u/2,this.cameraConstrain=new s({worldBounds:this.worldRectangle}),this.cameraConstrain.active=n.constrain===!0,this._screenWidth=a,this._screenHeight=u,this.worldContainer=new PIXI.Container,t.addChild.call(this,this.worldContainer),this._showMinimap=!1},this.destroyMinimap=function(){this._minimapInstance&&(this._minimapInstance=void 0,this.removeGlobalChild(this._minimapInstance))},this.createMinimap=function(t,n){if(!this._minimapInstance){var t=t||300,n=n||150,r=new a(t,n,this.camera);r.setWorldBounds(this.worldRectangle),r.position.set(this._screenWidth-t,this._screenHeight-n),this.addGlobalChild(r),this._minimapInstance=r}},this.setSize=function(t,n){this.worldRectangle.width=t,this.worldRectangle.height=n},this.setScreenSize=function(t,n){this._screenWidth=t,this._screenHeight=n,this.camera.setScreenSize(this._screenWidth,this._screenHeight)},this.addGlobalChild=function(n){t.addChild.call(this,n)},this.removeGlobalChild=function(n){t.removeChild.call(this,n)},this.addChild=function(t){this.worldContainer.addChild(t)},this.removeChild=function(t){this.worldContainer.removeChild(t)},this.update=function(){if(this.camera.update(),this.cameraConstrain.update(this.camera),this.minimap&&this._minimapInstance.update(),c.__updateMixed)for(var t=0,n=this.children.length;t<n;++t)this.children[t]&&this.children[t].update()},this.updateTransform=function(){t.updateTransform.call(this),this.updateWorldTransform()},this.updateWorldTransform=function(){var t=this.camera.transform,n=this.worldTransform,r=this.worldContainer.worldTransform;t.prepend(n);var e,i,o,a;e=this.worldContainer.scale.x,i=this.worldContainer.scale.y,o=this.worldContainer.position.x-this.worldContainer.pivot.x*e,a=this.worldContainer.position.y-this.worldContainer.pivot.y*i,r.a=e*t.a,r.b=e*t.b,r.c=i*t.c,r.d=i*t.d,r.tx=o*t.a+a*t.c+t.tx,r.ty=o*t.b+a*t.d+t.ty;for(var s=0,u=this.worldContainer.children.length;s<u;++s)this.worldContainer.children[s].updateTransform()}});c.mixinUpdates=function(){c.__updateMixed=!0,u.addContainerUpdates()},Object.defineProperty(c.prototype,"minimap",{get:function(){return this._showMinimap},set:function(t){this._showMinimap=t,this._showMinimap?this.createMinimap():this.destroyMinimap()}}),n.exports=c},{"./assert":2,"./camera":5,"./camera-constrain":3,"./math/rectangle":7,"./minimap":9,"./mixins":10,"./vendor/augment":12}]},{},[1])(1)});